name: "PostHog CI Metrics"
description: "Track workflow duration, success rates, and CI performance in PostHog"
author: "PostHog"
branding:
  icon: "activity"
  color: "orange"
inputs:
  posthog-token:
    description: 'Your PostHog API token - see project settings section "Project API Key"'
    required: true
  posthog-api-host:
    description: "Your PostHog API host"
    required: false
    default: "https://us.i.posthog.com"
  event:
    description: 'The event name e.g. "GitHubActionCompleted"'
    required: true
    default: "event-from-github-actions"
  properties:
    description: "Properties to add to the event - as a JSON string. Must be possible to `JSON.parse(properties)`"
    required: false
  capture-workflow-duration:
    description: "Capture workflow duration via GitHub API (adds duration_seconds and run metadata)"
    required: false
    default: "false"
  github-token:
    description: "GitHub token for API access (required for capture-workflow-duration and status-job)"
    required: false
  runner:
    description: "Optional runner label to include in properties (e.g., 'depot')"
    required: false
  status-job:
    description: "Job name to check for workflow status (e.g., 'Django Tests Pass'). Captures that job's conclusion."
    required: false
runs:
  using: "node20"
  main: "dist/index.js"
